# 📊 交易部位大小決定指南

## 🎯 如何決定買賣數量

### 基本原則

1. **風險控制第一**: 每筆交易最多風險 2% 的資金
2. **策略信心決定大小**: 信心越高，部位越大
3. **市場條件考量**: 波動率、成交量、流動性
4. **資金管理**: 總部位不超過資金的 10%

---

## 📈 策略分數對應部位大小

| 策略分數 | 信心等級 | 建議部位大小 | 說明 |
|---------|---------|-------------|------|
| 80-100  | 極高信心 | 8-10% 資金 | 強烈信號，可考慮最大部位 |
| 60-79   | 高信心   | 5-8% 資金  | 良好信號，適中部位 |
| 40-59   | 中等信心 | 2-5% 資金  | 一般信號，小部位 |
| 20-39   | 低信心   | 1-2% 資金  | 弱信號，最小部位 |
| 0-19    | 無信心   | 0% 資金    | 跳過交易 |

---

## 🧮 計算公式

### 基本公式
```
部位大小 = (風險金額) ÷ (進場價格 - 停損價格)
風險金額 = 總資金 × 最大風險比例 (2%)
```

### 實際範例
- **總資金**: $100,000
- **進場價格**: $100
- **停損價格**: $98
- **風險金額**: $100,000 × 2% = $2,000
- **部位大小**: $2,000 ÷ ($100 - $98) = 1,000 股
- **部位價值**: 1,000 × $100 = $100,000 (10% 資金)

---

## ⚠️ 風險管理規則

### 1. 每筆交易風險限制
- **最大風險**: 2% 總資金
- **最小風險**: 0.5% 總資金
- **建議風險**: 1-1.5% 總資金

### 2. 總部位限制
- **單一標的最大**: 10% 總資金
- **相關標的合計**: 15% 總資金
- **總投資部位**: 50% 總資金

### 3. 停損設定
- **固定停損**: 2-3% 進場價格
- **移動停損**: 根據波動率調整
- **時間停損**: 最大持有時間限制

---

## 📊 不同方法的部位計算

### 1. 凱利公式 (Kelly Criterion)
```
部位大小 = (勝率 × 平均獲利 - 敗率 × 平均虧損) ÷ 平均獲利
```
- **適用**: 有歷史交易數據
- **優點**: 數學上最優化
- **缺點**: 需要準確的歷史數據

### 2. 風險基礎法 (Risk-Based)
```
部位大小 = 最大風險金額 ÷ 每股風險
```
- **適用**: 有明確停損點
- **優點**: 風險控制明確
- **缺點**: 可能過於保守

### 3. 波動率基礎法 (Volatility-Based)
```
部位大小 = 信心分數 × 最大部位 × (1 ÷ 波動率)
```
- **適用**: 高波動市場
- **優點**: 適應市場條件
- **缺點**: 需要計算波動率

### 4. 成交量基礎法 (Volume-Based)
```
部位大小 = 信心分數 × 最大部位 × (當前成交量 ÷ 平均成交量)
```
- **適用**: 流動性考量
- **優點**: 考慮市場流動性
- **缺點**: 成交量可能不穩定

---

## 🎯 實用決策流程

### 步驟 1: 評估策略信心
1. 查看策略分數 (0-100)
2. 確認信號強度
3. 檢查多策略一致性

### 步驟 2: 計算基本部位
1. 設定停損價格
2. 計算每股風險
3. 計算最大股數

### 步驟 3: 調整部位大小
1. 根據信心分數調整
2. 考慮市場條件
3. 檢查風險限制

### 步驟 4: 最終確認
1. 確認不超過風險限制
2. 確認有足夠流動性
3. 確認符合資金管理規則

---

## 📋 檢查清單

### 交易前檢查
- [ ] 策略分數 > 40
- [ ] 風險 < 2% 總資金
- [ ] 部位大小 < 10% 總資金
- [ ] 有明確停損點
- [ ] 市場流動性充足

### 交易中檢查
- [ ] 定期檢查停損
- [ ] 監控部位表現
- [ ] 調整移動停損
- [ ] 評估加碼/減碼

### 交易後檢查
- [ ] 記錄交易結果
- [ ] 分析表現
- [ ] 調整策略參數
- [ ] 更新風險模型

---

## 🚨 常見錯誤

### ❌ 不要做的事
1. **過度交易**: 部位太小，交易成本過高
2. **過度槓桿**: 部位太大，風險過高
3. **無停損**: 沒有風險控制
4. **情緒交易**: 不按策略執行
5. **追高殺低**: 在極端價格進場

### ✅ 應該做的事
1. **嚴格執行**: 按策略和風險管理執行
2. **記錄交易**: 詳細記錄每筆交易
3. **定期檢討**: 分析交易表現
4. **持續學習**: 改進策略和風險管理
5. **保持紀律**: 遵守交易規則

---

## 💡 實用技巧

### 1. 分批進場
- 先建立 50% 部位
- 確認方向後再加碼
- 降低平均成本

### 2. 動態調整
- 根據市場條件調整
- 根據策略表現調整
- 根據資金狀況調整

### 3. 風險分散
- 不要把所有資金投入單一標的
- 考慮相關性
- 分散時間和標的

---

## 📞 需要幫助？

如果您需要更詳細的計算或建議，可以：
1. 使用 `position_sizing_calculator.py` 進行自動計算
2. 查看 `position_sizing_example.py` 的範例
3. 諮詢專業的風險管理顧問

記住：**風險管理比獲利更重要！** 